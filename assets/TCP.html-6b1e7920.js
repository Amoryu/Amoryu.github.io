import{_ as o,o as c,c as l,a,b as e,d as t}from"./app-52249f43.js";const r={},i=a('<h2 id="tcp三次握手" tabindex="-1"><a class="header-anchor" href="#tcp三次握手" aria-hidden="true">#</a> TCP三次握手</h2><ol><li><p>客户端向服务器发起连接请求 SYN</p></li><li><p>服务器收到连接请求，响应这个请求 ACK = SYN + 1</p></li><li><p>客户端收到响应，连接建立</p></li></ol><h2 id="tcp四次挥手" tabindex="-1"><a class="header-anchor" href="#tcp四次挥手" aria-hidden="true">#</a> TCP四次挥手</h2><p>TCP是全双工协议，客户端和服务端都可以主动断开连接</p><ol><li><p>客户端申请关闭连接 <code>向服务端发送FIN报文</code>（TCP首部的FIN标志为置为1的报文），进入FIN_WAIT_1状态</p></li><li><p>服务器收到断开连接的请求，<code>向客户端发送ACK应答报文</code>，服务端进入CLOSED_WAIT状态，（<strong>同意断开连接</strong>），客户端收到ACK应答报文后，进入FIN_WAIT_2状态</p></li><li><p>服务器传输完剩余数据，<code>向客户端发送FIN报文</code>，进入LAST_ACK状态，再次响应客户端<strong>关闭连接</strong></p></li><li><p>客户端收到FIN报文后，<code>回送服务端一个ACK应答报文</code>，进入TIME_WAIT状态（主动发起关闭连接的一方，才有TIME_WAIT状态）</p></li></ol><p>服务端收到ACK应答报文后，进入CLOSE状态，完成连接的关闭；客户端经过2MSL一段时间后，自动进入CLOSE状态，完成连接的关闭</p>',6),n=e("div",{class:"custom-container tip"},[e("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},[e("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("circle",{cx:"12",cy:"12",r:"9"}),e("path",{d:"M12 8h.01"}),e("path",{d:"M11 12h1v4h1"})])]),e("p",{class:"custom-container-title"},"TIP"),e("h3",{id:"为什么是四次挥手-可以是三次吗",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#为什么是四次挥手-可以是三次吗","aria-hidden":"true"},"#"),t(" 为什么是四次挥手，可以是三次吗")]),e("p",null,[t("因为"),e("strong",null,"socket由本地应用程序拥有和管理"),t("，是否继续从socket读取数据 (数据没读完可以继续读)、向socket发送数据 (数据没发完可以继续发) 或关闭socket都应该由应用程序决定，TCP自身无法管理这种有状态的socket。")]),e("p",null,"因此，第三步由应用程序决定是否关闭socket进而发送FIN，无法与第二步合在一起，这才有了四次挥手。"),e("h3",{id:"可以是三次挥手",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#可以是三次挥手","aria-hidden":"true"},"#"),t(" 可以是三次挥手")]),e("p",null,[t("服务端通常需要等待完成数据的发送和处理，所以服务端的 "),e("code",null,"ACK"),t(" 和 "),e("code",null,"FIN"),t(" 一般都会分开发送，从而比三次握手导致多了一次，如果服务端刚好发完了数据，就可以将ACK和FIN合并发送，实现三次挥手")])],-1),s=[i,n];function d(h,p){return c(),l("div",null,s)}const u=o(r,[["render",d],["__file","TCP.html.vue"]]);export{u as default};
